# GPIO驱动解读

## drv_pin.c解读

### 结构体

``` 
const rt_int8_t gpio_reg_offset[5][32] = 
{
    { 6,  7,  8,  9, 10, 11, 12, 13, 14, 15,  0,  1,  2,  3,  4,  5, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,},
    {32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 94, 95, 96, 97, 98, 99, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,},
    {48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, -1, -1, -1,},
    {77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93,100,101,102,103,104,105,106,107,108,109,110,111, -1, -1, -1,},
    { 2,  3,  4,  5,  6,  7,  8,  9, 10, 11,  0,  1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,},
};
```

作用：用于查询对应管脚的IOMUXC寄存器地址

### 函数static void imx6ull_pin_mode(struct rt_device *device, rt_base_t pin, rt_base_t mode)

用于设置管脚复用为GPIO模式，以及设置管脚电气模式

其中：

``` 
*device --未使用
pin管脚编号，具体为端口号×32 + 管脚号，例如GPIO1-IO09，pin=1*32+9=41
mode:
	#define PIN_MODE_OUTPUT 0x00            /* 输出 */
	#define PIN_MODE_INPUT 0x01             /* 输入 */
	#define PIN_MODE_INPUT_PULLUP 0x02      /* 上拉输入 */
	#define PIN_MODE_INPUT_PULLDOWN 0x03    /* 下拉输入 */
	#define PIN_MODE_OUTPUT_OD 0x04         /* 开漏输出 */
```

